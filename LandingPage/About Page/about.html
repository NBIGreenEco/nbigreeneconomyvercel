<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Fix for Google Translate proxy: when translate serves a proxied page, root-relative URLs (starting with /) point to the proxy origin and break asset loading. -->
    <script>
      (function() {
        try {
          var ref = document.referrer || '';
          if (!ref) return;
          var refOrigin = new URL(ref).origin;
          var hostname = window.location.hostname || '';
          var isProxy = /translate|googleusercontent|goog/.test(hostname) && refOrigin.indexOf(hostname) === -1;
          if (!isProxy) return;
          var map = [ ['link','href'], ['script','src'], ['img','src'], ['a','href'] ];
          map.forEach(function(pair) {
            var tag = pair[0], attr = pair[1];
            var nodes = document.getElementsByTagName(tag);
            for (var i = 0; i < nodes.length; i++) {
              var el = nodes[i];
              var v = el.getAttribute(attr);
              if (!v) continue;
              if (v.indexOf('/') === 0) {
                el.setAttribute(attr, refOrigin + v);
              } else if (v.indexOf('./') === 0) {
                el.setAttribute(attr, refOrigin + v.slice(1));
              }
            }
          });
          var base = document.querySelector('base');
          if (!base) {
            base = document.createElement('base');
            document.head.insertBefore(base, document.head.firstChild);
          }
          base.setAttribute('href', refOrigin + '/');

        // Inject protective CSS to override Google Translate's hiding rules
        var protectiveStyle = document.createElement('style');
        protectiveStyle.id = 'navbar-protection-css';
        protectiveStyle.innerHTML = 
          '.header-outer, .header, .nav, .nav-links, .nav-utils, ' +
          '.nav a, .search-icon, .language-selector, #google_translate_element { ' +
          'display: block !important; visibility: visible !important; opacity: 1 !important; } ' +
          '.header { display: flex !important; } ' +
          '.nav, .nav-links, .nav-utils { display: flex !important; } ' +
          '.nav a { color: white !important; background-color: #2b9589 !important; display: flex !important; align-items: center !important; justify-content: center !important; padding: 0 2rem !important; padding-top: 0 !important; } ' +
          '.nav a:nth-child(2), .nav a:nth-child(3), .nav a:nth-child(4) { padding-top: 12px !important; } ' +
          '.search-icon { color: white !important; background-color: #2b9589 !important; display: flex !important; } ' +
          '.language-selector { background-color: #207e74 !important; color: white !important; padding-top: 12px !important; } ' +
          '#google_translate_element { display: inline-block !important; background: transparent !important; border: none !important; } ' +
          '.goog-te-gadget { background-color: transparent !important; border: none !important; font-size: 0 !important; } ' +
          '.goog-te-combo { display: inline-flex !important; align-items: center !important; justify-content: center !important; background-color: #2b9589 !important; color: white !important; border: none !important; height: 70px !important; padding: 0 2rem !important; padding-top: 12px !important; margin: 0 !important; font-size: 0.9rem !important; font-weight: 600 !important; line-height: 1.2 !important; } ' +
          '.goog-te-combo:hover { background-color: #4ec3b0 !important; } ' +
          '.goog-te-banner-frame { display: none !important; }';
        document.head.appendChild(protectiveStyle);
        console.log('Applied Google Translate proxy asset fix — using origin:', refOrigin);
        } catch (e) {
          console.warn('Translate proxy fix failed:', e);
        }
      })();
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="about.title">Green Economy Toolkit - About</title>
    <script src="https://unpkg.com/i18next@22/i18next.min.js"></script>
    <script src="https://unpkg.com/i18next-http-backend@2.2.0/i18nextHttpBackend.min.js"></script>
    <script src="https://unpkg.com/i18next-browser-languagedetector@7.0.1/i18nextBrowserLanguageDetector.min.js"></script>
    
    <!-- Translation System (Unofficial Google Translate API) -->
    <script>
      let currentLanguage = 'en';

      // Translate a single piece of text
      async function translateText(text, targetLang) {
        const sourceLang = currentLanguage || 'en';
        const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=${sourceLang}&tl=${targetLang}&dt=t&q=${encodeURIComponent(text)}`;
        try {
          const res = await fetch(url);
          const data = await res.json();
          return data[0].map(seg => seg[0]).join('');
        } catch (e) {
          console.error('Translation error:', e);
          return text;
        }
      }

      // Translate the whole page (all text nodes)
      async function translatePage(targetLang) {
        const selector = document.getElementById('langSelect');
        if (!selector) return;
        
        const original = selector.dataset.original || selector.options[selector.selectedIndex].text;
        selector.dataset.original = original;

        const translating = targetLang === 'en' ? 'English' :
                            targetLang === 'zu' ? 'isiZulu' :
                            'Setswana';
        selector.options[selector.selectedIndex].text = `Translating to ${translating}…`;

        const walker = document.createTreeWalker(
          document.body,
          NodeFilter.SHOW_TEXT,
          {
            acceptNode: node => {
              const p = node.parentNode;
              if (!p) return NodeFilter.FILTER_REJECT;
              const tag = p.tagName;
              if (tag === 'SCRIPT' || tag === 'STYLE' || tag === 'NOSCRIPT') return NodeFilter.FILTER_REJECT;
              return node.nodeValue.trim() ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_REJECT;
            }
          }
        );

        const nodes = [];
        let n;
        while (n = walker.nextNode()) nodes.push(n);

        const BATCH = 15;
        for (let i = 0; i < nodes.length; i += BATCH) {
          const batch = nodes.slice(i, i + BATCH);
          const promises = batch.map(node => translateText(node.nodeValue, targetLang));
          const results = await Promise.all(promises);
          batch.forEach((node, idx) => node.nodeValue = results[idx]);
        }

        selector.options[selector.selectedIndex].text = original;
        currentLanguage = targetLang;
      }

      function onLangChange() {
        const lang = this.value;
        if (lang === 'en') {
          location.reload();
          return;
        }
        translatePage(lang).catch(err => {
          console.error(err);
          alert('Translation failed – check your internet connection.');
        });
      }
    </script>
    
    <script type="module" src="../../Trans.js"></script>
    <script type="module" src="../../Master Page(Header and Footer)/MasterPage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="../../Master Page(Header and Footer)/MasterPage.css">
    <link rel="stylesheet" href="about.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/digital_human/digital-human.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="../../scripts/enhancedsearch.js"></script>
    
    <!-- Add Contentful service -->
    <script src="../../scripts/contentful-service.js" defer></script>
    
    <!-- Translation system is now in MasterPage header -->
    
    <style>
        .loader {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            border: 8px solid #e5e7eb;
            border-top: 8px solid #10b981;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            z-index: 1000;
        }
        .loader-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        #verification-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 24px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1001;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }
        #verification-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        #verification-modal button {
            background-color: #10b981;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        #verification-modal button:hover {
            background-color: #059669;
        }
        * {
            font-family: 'Poppins', sans-serif;
        }
        .animate-fade-in {
            animation: fadeIn 1s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .light-section {
            background-color: #f8f9fa;
        }
        .focus-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            width: 100%;
            gap: 0;
        }
        .focus-item {
            position: relative;
            height: 300px;
            background-size: cover;
            background-position: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .focus-item:hover {
            transform: scale(1.02);
            z-index: 1;
        }
        .focus-content {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 1rem;
            text-align: center;
        }
        .focus-content h3 {
            font-size: 1.5rem;
            font-weight: 600;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
        }
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #f8f9fa;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #10b981;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        body.loading {
            visibility: hidden;
            opacity: 0;
        }
        body.loaded {
            visibility: visible;
            opacity: 1;
            transition: opacity 0.3s;
        }
        
        /* Climate risks grid styling */
        .climate-risks-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: 1fr 1fr;
            gap: 0;
            width: 100%;
            height: 70vh;
            margin: 0;
            background-color: #009381;
            border: 1px solid white;
            border-collapse: collapse;
        }
        .climate-risk-item {
            padding: 2% 3%;
            color: white;
            border-right: 1px solid white;
            border-bottom: 1px solid white;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .climate-risk-item:nth-child(3) {
            border-right: none;
        }
        .climate-risk-item:nth-child(4),
        .climate-risk-item:nth-child(5) {
            border-bottom: none;
        }
        .climate-risk-item:nth-child(5) {
            border-right: none;
        }
        .climate-risk-item:nth-child(4) {
            grid-column: 1 / span 2;
        }
        
        /* Climate responses styling */
        .climate-responses-container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
        }
        .climate-response-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin-bottom: 30px;
        }
        .climate-response-card {
            background: #009381;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .climate-response-image {
            height: 200px;
            background-size: cover;
            background-position: center;
        }
        .climate-response-content {
            padding: 25px;
            color: white;
        }
        
        /* Mobile responsive styles */
        @media (max-width: 1024px) {
            .hero-section {
                flex-direction: column;
                min-height: auto;
            }
            .hero-image,
            .hero-text-container {
                width: 100%;
            }
            .hero-image {
                height: 300px;
            }
            .hero-text-content {
                position: relative;
                padding: 1.5rem;
            }
            .hero-text {
                margin-left: 0 !important;
            }
            .hero-text h1 {
                font-size: 2rem !important;
                margin-bottom: 20px;
            }
            .hero-text p {
                font-size: 0.95rem;
                line-height: 1.6;
            }
            .focus-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .focus-content h3 {
                font-size: 1.1rem;
            }
            .climate-risks-grid {
                height: auto;
                grid-template-columns: 1fr;
                grid-template-rows: auto;
            }
            .climate-risk-item {
                border-right: none;
                border-bottom: 1px solid white;
                min-height: 150px;
                padding: 5% 5%;
            }
            .climate-risk-item:nth-child(4) {
                grid-column: 1;
            }
            .climate-risk-item:last-child {
                border-bottom: none;
            }
            .climate-response-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            .climate-responses-container {
                width: 95%;
                padding: 0 10px;
            }
        }
        
        @media (max-width: 768px) {
            .hero-text h1 {
                font-size: 1.75rem !important;
                margin-bottom: 15px;
            }
            .hero-text p {
                font-size: 0.9rem;
                line-height: 1.5;
            }
            .hero-image {
                height: 250px;
            }
            .focus-grid {
                grid-template-columns: 1fr;
            }
            .focus-item {
                height: 200px;
            }
            .focus-content h3 {
                font-size: 1rem;
                padding: 0 10px;
            }
            .py-16 {
                padding-top: 2rem !important;
                padding-bottom: 2rem !important;
            }
            .text-3xl {
                font-size: 1.5rem !important;
            }
            .text-4xl {
                font-size: 1.75rem !important;
            }
            .text-2xl {
                font-size: 1.25rem !important;
            }
            .text-lg {
                font-size: 1rem !important;
            }
            .mb-12 {
                margin-bottom: 1.5rem !important;
            }
            .climate-risk-item {
                min-height: 120px;
                padding: 6% 5%;
                font-size: 0.9rem;
            }
            .climate-response-content {
                padding: 20px;
                font-size: 0.9rem;
            }
            .climate-response-image {
                height: 150px;
            }
            .login-section h2 {
                font-size: 1.1rem !important;
                padding: 0 15px;
                margin-bottom: 20px !important;
            }
            .login-section form {
                padding: 0 15px 20px;
            }
            .login-section input {
                padding: 15px 45px 15px 20px !important;
                font-size: 14px !important;
            }
            .login-section button {
                font-size: 20px !important;
                right: 20px !important;
            }
        }
        
        @media (max-width: 480px) {
            .hero-text h1 {
                font-size: 1.5rem !important;
            }
            .hero-text p {
                font-size: 0.85rem;
            }
            .hero-image {
                height: 200px;
            }
            .focus-item {
                height: 180px;
            }
            .focus-content h3 {
                font-size: 0.9rem;
            }
            .text-3xl {
                font-size: 1.25rem !important;
            }
            .text-4xl {
                font-size: 1.5rem !important;
            }
            .climate-risk-item {
                min-height: 100px;
                padding: 5% 4%;
                font-size: 0.85rem;
            }
            .climate-response-content {
                padding: 15px;
                font-size: 0.85rem;
            }
            .climate-responses-container h2 {
                font-size: 1.25rem !important;
            }
        }
    </style>
    <script type="module">
        import { updateContent } from '../../Trans.js';

        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCfa827mvCLf1ETts6B_DmCfb7owTohBxk",
            authDomain: "nbi-green-economy.firebaseapp.com",
            projectId: "nbi-green-economy",
            storageBucket: "nbi-green-economy.appspot.com",
            messagingSenderId: "53732340059",
            appId: "1:53732340059:web:3fb3f086c6662e1e9baa7e",
            measurementId: "G-37VRZ5CGE4"
        };
        firebase.initializeApp(firebaseConfig);

        // Initialize i18next
        i18next
            .use(i18nextHttpBackend)
            .use(i18nextBrowserLanguageDetector)
            .init({
                fallbackLng: 'en',
                supportedLngs: ['en', 'zu', 'tn'],
                backend: { 
                    loadPath: '/locales/{{lng}}.json?v=' + new Date().getTime()
                },
                detection: {
                    order: ['querystring', 'cookie', 'localStorage', 'navigator', 'htmlTag'],
                    caches: ['localStorage', 'cookie']
                }
            }, (err, t) => {
                if (err) {
                    console.error('i18next initialization error:', err);
                    setTimeout(() => {
                        i18next.loadResources((loadErr) => {
                            if (loadErr) {
                                console.error('Retry failed:', loadErr);
                                applyFallbackTranslations();
                            } else {
                                console.log('i18next retry successful, language:', i18next.language);
                                finalizeLoading();
                            }
                        });
                    }, 2000);
                    return;
                }
                console.log('i18next initialized for about.html at', new Date().toLocaleString('en-ZA'), 'language:', i18next.language);
                finalizeLoading();
            });

        function applyFallbackTranslations() {
            document.querySelectorAll('[data-i18n]').forEach(elem => {
                const key = elem.getAttribute('data-i18n');
                try {
                    if (key.startsWith('[')) {
                        const match = key.match(/\[(\w+)\](.+)/);
                        if (match) {
                            const [, attr, i18nKey] = match;
                            const fallback = elem.getAttribute(attr) || 'Content not available';
                            elem.setAttribute(attr, fallback);
                            console.warn(`Fallback applied for attribute ${attr} with key ${i18nKey}: ${fallback}`);
                        } else {
                            console.error(`Invalid data-i18n format for key: ${key}`);
                        }
                    } else {
                        const fallback = elem.textContent.trim() || 'Content not available';
                        elem.textContent = fallback;
                        console.warn(`Fallback applied for text with key ${key}: ${fallback}`);
                    }
                } catch (error) {
                    console.error(`Error applying fallback for key ${key}:`, error);
                }
            });
            console.warn('Applied fallback translations due to loading failure');
            finalizeLoading();
        }

        function finalizeLoading() {
            try {
                i18next.loadResources(() => {
                    updateContent();
                    document.body.classList.remove('loading');
                    document.body.classList.add('loaded');
                    document.querySelector('.loading-overlay').style.display = 'none';
                    console.log('Translations loaded, content displayed');
                });
            } catch (error) {
                console.error('Error loading translations:', error);
                applyFallbackTranslations();
            }
        }

        i18next.on('languageChanged', () => {
            console.log('Language changed to:', i18next.language);
            updateContent();
        });

        i18next.on('loaded', () => {
            console.log('Resources loaded for:', i18next.language);
            updateContent();
        });

        i18next.on('failedLoading', (lng, ns, msg) => {
            console.error(`Failed to load ${lng}.json: ${msg}`);
            applyFallbackTranslations();
        });

        // Contentful loading functions
        async function loadFocusAreas() {
            try {
                console.log('Loading focus areas from Contentful...');
                const focusAreas = await window.contentfulService.getFocusAreas();
                const grid = document.getElementById('about-priority-areas');
                
                if (!grid) {
                    console.error('Focus areas grid not found');
                    return;
                }

                grid.innerHTML = '';
                
                focusAreas.forEach(area => {
                    const focusItem = document.createElement('a');
                    focusItem.href = area.fields.linkUrl || '../energy.html';
                    focusItem.className = 'focus-item';
                    
                    const imageUrl = area.fields.image || getFallbackImage(area.fields.title);
                    focusItem.style.backgroundImage = `url('${imageUrl}')`;
                    
                    focusItem.innerHTML = `
                        <div class="focus-content">
                            <h3>${area.fields.title}</h3>
                        </div>
                    `;
                    
                    grid.appendChild(focusItem);
                });
                
                console.log('Focus areas loaded successfully');
            } catch (error) {
                console.error('Error loading focus areas:', error);
                loadStaticFocusAreas();
            }
        }

        function getFallbackImage(title) {
            const fallbackImages = {
                'agriculture': 'https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=400&h=300&fit=crop',
                'energy': 'https://images.unsplash.com/photo-1466611653911-95081537e5b7?w=400&h=300&fit=crop',
                'natural resource': 'https://static.vecteezy.com/system/resources/previews/006/037/285/large_2x/close-up-hand-holding-young-green-tree-sprout-and-planting-in-soil-free-photo.JPG',
                'transport': 'https://images.unsplash.com/photo-1544620347-c4fd4a3d5957?w=400&h=300&fit=crop',
                'environmental': 'https://images.unsplash.com/photo-1473341304170-971dccb5ac1e?w=400&h=300&fit=crop',
                'buildings': 'https://d1v1e13ebw3o15.cloudfront.net/data/42690/pool_and_spa_master/..jpg',
                'waste': 'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400&h=300&fit=crop',
                'water': 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=400&h=300&fit=crop',
                'production': 'https://images.unsplash.com/photo-1532996122724-e3c354a0b15b?w=400&h=300&fit=crop'
            };
            
            const lowerTitle = title.toLowerCase();
            for (const [key, image] of Object.entries(fallbackImages)) {
                if (lowerTitle.includes(key)) {
                    return image;
                }
            }
            
            return 'https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=400&h=300&fit=crop';
        }

        function loadStaticFocusAreas() {
            const grid = document.getElementById('about-priority-areas');
            if (!grid) return;
            
            grid.innerHTML = `
                <a href="../energy.html" class="focus-item" style="background-image: url('https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=400&h=300&fit=crop');">
                    <div class="focus-content">
                        <h3>Agriculture</h3>
                    </div>
                </a>
                <a href="../energy.html" class="focus-item" style="background-image: url('https://images.unsplash.com/photo-1466611653911-95081537e5b7?w=400&h=300&fit=crop');">
                    <div class="focus-content">
                        <h3>Energy (clean and efficient)</h3>
                    </div>
                </a>
                <a href="../natural.html" class="focus-item" style="background-image: url('https://static.vecteezy.com/system/resources/previews/006/037/285/large_2x/close-up-hand-holding-young-green-tree-sprout-and-planting-in-soil-free-photo.JPG');">
                    <div class="focus-content">
                        <h3>Natural resource conservation and management (including mining)</h3>
                    </div>
                </a>
                <a href="../transport.html" class="focus-item" style="background-image: url('https://images.unsplash.com/photo-1544620347-c4fd4a3d5957?w=400&h=300&fit=crop');">
                    <div class="focus-content">
                        <h3>Sustainable transport and infrastructure</h3>
                    </div>
                </a>
                <a href="../environment.html" class="focus-item" style="background-image: url('https://images.unsplash.com/photo-1473341304170-971dccb5ac1e?w=400&h=300&fit=crop');">
                    <div class="focus-content">
                        <h3>Environmental sustainability, including tourism education</h3>
                    </div>
                </a>
                <a href="../building.html" class="focus-item" style="background-image: url('https://d1v1e13ebw3o15.cloudfront.net/data/42690/pool_and_spa_master/..jpg');">
                    <div class="focus-content">
                        <h3>Green buildings and the built environment</h3>
                    </div>
                </a>
                <a href="../waste.html" class="focus-item" style="background-image: url('https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400&h=300&fit=crop');">
                    <div class="focus-content">
                        <h3>Sustainable waste management and recycling</h3>
                    </div>
                </a>
                <a href="../water.html" class="focus-item" style="background-image: url('https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=400&h=300&fit=crop');">
                    <div class="focus-content">
                        <h3>Water management</h3>
                    </div>
                </a>
                <a href="../production.html" class="focus-item" style="background-image: url('https://images.unsplash.com/photo-1532996122724-e3c354a0b15b?w=400&h=300&fit=crop');">
                    <div class="focus-content">
                        <h3>Sustainable production and consumption</h3>
                    </div>
                </a>
            `;
        }

        function initializeContentfulContent() {
            if (window.contentfulService) {
                window.contentfulService.initialize().then(() => {
                    loadFocusAreas();
                }).catch(error => {
                    console.error('Contentful service initialization failed:', error);
                    loadStaticFocusAreas();
                });
            } else {
                console.warn('Contentful service not available, loading static focus areas');
                loadStaticFocusAreas();
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM fully loaded for about.html at', new Date().toLocaleString('en-ZA'));
            
            setTimeout(() => {
                initializeContentfulContent();
            }, 1000);

            setTimeout(() => {
                if (document.body.classList.contains('loading')) {
                    console.warn('Loading timeout reached, forcing content display');
                    applyFallbackTranslations();
                    document.body.classList.remove('loading');
                    document.body.classList.add('loaded');
                    document.querySelector('.loading-overlay').style.display = 'none';
                }
            }, 10000);

            // Digital Human Widget Logic
            const pulsingIcon = document.querySelector('.pulsing-icon');
            const videoOverlay = document.querySelector('.video-overlay');
            const closeVideo = document.querySelector('.close-video');
            const floatingVideo = document.getElementById('floatingVideo');
            const langButtons = document.querySelectorAll('.lang-btn');
            const videoSources = {
                'eng': '/Videos/About_Eng.mp4',
                'zulu': '/Videos/About_Zulu.mp4',
                'tswana': '/Videos/About_Tswana.mp4'
            };
            let currentLang = 'eng';

            if (pulsingIcon) {
                pulsingIcon.addEventListener('click', function(e) {
                    e.preventDefault();
                    videoOverlay.classList.toggle('active');
                    if (videoOverlay.classList.contains('active')) {
                        playCurrentVideo();
                        pulsingIcon.style.opacity = '0.7';
                    } else {
                        floatingVideo.pause();
                        pulsingIcon.style.opacity = '1';
                    }
                });
            }

            if (closeVideo) {
                closeVideo.addEventListener('click', function(e) {
                    e.stopPropagation();
                    closeVideoPlayer();
                });
            }

            if (videoOverlay) {
                videoOverlay.addEventListener('click', function(e) {
                    if (e.target === videoOverlay) {
                        closeVideoPlayer();
                    }
                });
            }

            langButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const lang = this.getAttribute('data-lang');
                    if (lang !== currentLang) {
                        langButtons.forEach(btn => btn.classList.remove('active'));
                        this.classList.add('active');
                        currentLang = lang;
                        playCurrentVideo();
                    }
                });
            });

            if (floatingVideo) {
                floatingVideo.addEventListener('ended', function() {
                    closeVideoPlayer();
                });
            }

            function playCurrentVideo() {
                const source = videoSources[currentLang];
                if (source && floatingVideo) {
                    const currentTime = floatingVideo.currentTime;
                    floatingVideo.src = source;
                    floatingVideo.load();
                    floatingVideo.currentTime = currentTime;
                    floatingVideo.play().catch(e => console.log('Video play failed:', e));
                }
            }

            function closeVideoPlayer() {
                if (videoOverlay && floatingVideo && pulsingIcon) {
                    videoOverlay.classList.remove('active');
                    floatingVideo.pause();
                    pulsingIcon.style.opacity = '1';
                }
            }

            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && videoOverlay && videoOverlay.classList.contains('active')) {
                    closeVideoPlayer();
                }
            });
        });
    </script>
</head>
<body class="loading">
    <div class="loading-overlay">
        <div class="loading-spinner"></div>
    </div>
    <div id="root">
        <green-economy-header></green-economy-header>
        <main>
            <section class="hero-section">
                <div class="hero-image">
                    <img src="../../Images/about.JPG"
                         alt="Professional woman in safety vest"
                         class="image-cover"
                         data-i18n="[alt]about.hero_image">
                </div>
                <div class="hero-text-container">
                    <div class="hero-text-content">
                        <div class="hero-text" style="margin-left: 50px;">
                            <h1 id="hero-title" data-i18n="about.hero_title">ABOUT THE GREEN ECONOMY</h1>
                            <p id="hero-description" data-i18n="about.hero_description">
                                A green economy is one which is socially inclusive and environmentally sustainable.
                                It improves human well-being and builds social equity while reducing environmental
                                risks and ecological scarcities. In simple terms, we can think of a green economy
                                as one which is low carbon, resource efficient and socially inclusive.
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <script id="messenger-widget-b" src="https://cdn.botpenguin.com/website-bot.js" defer>6912ee821c29f29c0d7d6882,6912edf6e9437105db53226c,agent</script>
            <section class="py-16 light-section" style="color: #36aa51; text-align: center;">
                <div class="w-full">
                    <div class="text-center max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 focus-title">
                        <h3 class="text-2xl lg:text-3xl font-semibold mb-4" data-i18n="about.priority_title">
                            Nine priority focus areas for the green economy in South Africa
                        </h3>
                        <p class="text-base font-semibold mb-12" data-i18n="about.priority_subtitle">
                            (Green Economy Summit, 2010)
                        </p>
                    </div>
                    <div class="focus-grid text-sm" id="about-priority-areas">
                        <!-- Content will be populated by JavaScript from Contentful -->
                    </div>
                </div>
            </section>
            <section class="py-16 bg-white" style="color: #009381;text-align: center;">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                    <h2 class="text-3xl lg:text-4xl font-bold mb-4" data-i18n="about.climate_risks_title">Climate risks</h2>
                    <p class="text-lg font-bold" data-i18n="about.climate_risks_subtitle">How will climate change affect your business?</p>
                </div>
            </section>
            <section style="width: 100%; height: 70vh; margin: 0; background-color: #009381; padding: 0; overflow: hidden;">
                <div class="climate-risks-grid" id="climate-risks-grid">
                    <!-- Content will be populated by JavaScript from Contentful -->
                </div>
            </section>
            <section style="width: 100%; background-color: #aedfe4; padding: 40px 0;">
                <div class="climate-responses-container">
                    <h2 style="text-align: center; font-size: 28px; margin-bottom: 40px; color: #009381;" data-i18n="about.response_title">How we can respond to climate change</h2>
                    <div id="climate-responses-container">
                        <!-- Content will be populated by JavaScript from Contentful -->
                    </div>
                </div>
            </section>
            <section class="partners">
                <div class="partners-content" id="partners-container">
                    <!-- Content will be populated by JavaScript from Contentful -->
                </div>
            </section>
            <section class="login-section">
                <div style="position: relative; max-width: 700px; margin: 0 auto;">
                    <h2 style="color: white; font-size: 20px; margin-bottom: 25px; max-width: 600px; margin-left: auto; margin-right: auto;" id="newsletter-title">
                        Subscribe to our newsletter to get the latest information
                    </h2>
                    <form style="position: relative; padding-bottom: 20px;">
                        <input
                            type="email"
                            placeholder="Your email"
                            style="width: 100%; padding: 18px 50px 18px 25px; border: none; border-radius: 4px; font-size: 16px; color: #333; background: white;"
                            id="newsletter-email"
                        >
                        <button
                            type="submit"
                            style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; font-size: 22px; color: #009381; cursor: pointer;"
                            title="Submit"
                            id="newsletter-submit"
                        >
                            →
                        </button>
                    </form>
                </div>
            </section>
            <!-- Digital Human Widget -->
            <div class="video-overlay" id="videoOverlay">
                <div class="video-container">
                    <span class="close-video">&times;</span>
                    <div class="language-toggles">
                        <button class="lang-btn active" data-lang="eng">English</button>
                        <button class="lang-btn" data-lang="zulu">Zulu</button>
                        <button class="lang-btn" data-lang="tswana">Tswana</button>
                    </div>
                    <video
                        id="floatingVideo"
                        playsinline
                        loop
                        disablepictureinpicture
                        controlslist="nodownload nofullscreen noremoteplayback"
                    ></video>
                </div>
            </div>
            <div class="pulsing-icon" id="pulsingIcon">
                <video autoplay muted loop playsinline>
                    <source src="/Videos/idle.mp4" type="video/mp4" />
                </video>
            </div>
            <link rel="stylesheet" href="/digital_human/digital-human.css" />
            <script src="/digital_human/digital-human.js" defer></script>
            <!-- Digital Human Widget End -->
            <green-economy-chatbot></green-economy-chatbot>
            <green-economy-footer></green-economy-footer>
        </main>
    </div>
    <script src="../../scripts/about.js" defer></script>
    <script src="../../scripts/chatbot.js" defer></script>
</body>
</html>